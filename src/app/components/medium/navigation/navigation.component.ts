import { Component, computed, inject, signal, Signal, WritableSignal } from '@angular/core';
import { NavigationBtnComponent } from '../../small/navigation-btn/navigation-btn.component';
import { CommonModule } from '@angular/common';
import { toSignal } from '@angular/core/rxjs-interop';
import { MediaQueryService } from '../../../shared-services/media-query.service';
import { HoverDirective } from '../../../shared-directives/hover.directive';
import { ActivatedRoute, RouterLink, RouterLinkActive } from '@angular/router';
import { Router } from '@angular/router';
import { animate, state, style, transition, trigger } from '@angular/animations';
import { SafeHtmlPipe } from '../../../shared-pipes/safe-html.pipe';


interface NavLink {
  title: string,
  isActive: boolean,
  path: string
}
@Component({
  selector: 'app-navigation',
  standalone: true,
  imports: [NavigationBtnComponent, CommonModule, HoverDirective, RouterLink, RouterLinkActive, SafeHtmlPipe],
  templateUrl: './navigation.component.html',
  styleUrl: './navigation.component.css',
  animations: [
        trigger('minimize', [
          transition('* => void', [animate(100, style({
            transform: 'translateX(100%)'
          }))]),
          transition('void => *', style(
            {
              transform: 'translateX(-100%)'
            }
          ))
        ])
      ]
})

export class NavigationComponent {
 router = inject(Router)
 route = inject(ActivatedRoute)
 isMinimized = true
  #mediaQueryService = inject(MediaQueryService)
            isMobile = toSignal(this.#mediaQueryService.mediaQuery('max', 'md'));
            isDesktop = toSignal(this.#mediaQueryService.mediaQuery('min', 'lg'));
            isTablet  = computed(() => (!this.isMobile() && !this.isDesktop()))
  isShown: WritableSignal<boolean> = signal(true)
          navigationBtns = signal([
              {title: "Overview", isActive: true, path: 'overview'},
              {title: "Transactions", isActive: false, path: 'transactions'},
              {title: "Budgets", isActive: false, path: 'budgets'},
              {title: "Pots", isActive: false, path: 'pots'},
              {title: "Recurring Bills", isActive: false, path: 'bills'},
            ])

      navigationIcons: string[] = [
              `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M21 10.8328L21 19.5C21 19.8978 20.842 20.2793 20.5607 20.5607C20.2794 20.842 19.8978 21 19.5 21H15.75C15.3522 21 14.9706 20.842 14.6893 20.5607C14.408 20.2793 14.25 19.8978 14.25 19.5L14.25 15.75C14.25 15.5511 14.171 15.3603 14.0303 15.2197C13.8897 15.079 13.6989 15 13.5 15H10.5C10.3011 15 10.1103 15.079 9.96967 15.2197C9.82902 15.3603 9.75 15.5511 9.75 15.75L9.75 19.5C9.75 19.8978 9.59196 20.2793 9.31066 20.5607C9.02936 20.842 8.64782 21 8.25 21H4.5C4.10218 21 3.72064 20.842 3.43934 20.5607C3.15804 20.2793 3 19.8978 3 19.5L3 10.8328C2.99997 10.6252 3.04303 10.4199 3.12646 10.2298C3.20989 10.0397 3.33187 9.86895 3.48469 9.72843L10.9847 2.65218L10.995 2.64187C11.2711 2.39074 11.631 2.25159 12.0042 2.25159C12.3775 2.25159 12.7373 2.39074 13.0134 2.64187C13.0166 2.64554 13.0201 2.64898 13.0237 2.65218L20.5237 9.72843C20.675 9.86969 20.7954 10.0407 20.8774 10.2308C20.9594 10.4209 21.0011 10.6258 21 10.8328Z" fill="#B3B3B3"/>
        </svg>`,
        `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M11.1928 16.2131C11.2496 16.3501 11.2646 16.5009 11.2357 16.6465C11.2068 16.792 11.1355 16.9257 11.0306 17.0306L8.03061 20.0306C7.96095 20.1003 7.87823 20.1557 7.78719 20.1934C7.69614 20.2311 7.59854 20.2506 7.49998 20.2506C7.40142 20.2506 7.30382 20.2311 7.21278 20.1934C7.12173 20.1557 7.03901 20.1003 6.96936 20.0306L3.96936 17.0306C3.86435 16.9257 3.79282 16.792 3.76383 16.6465C3.73485 16.5009 3.7497 16.35 3.80651 16.2129C3.86333 16.0758 3.95955 15.9586 4.08299 15.8762C4.20644 15.7938 4.35156 15.7499 4.49998 15.75H6.74998L6.74998 4.49998C6.74998 4.30107 6.829 4.1103 6.96965 3.96965C7.1103 3.829 7.30107 3.74998 7.49998 3.74998C7.69889 3.74998 7.88966 3.829 8.03031 3.96965C8.17096 4.1103 8.24998 4.30107 8.24998 4.49998L8.24998 15.75L10.5 15.75C10.6483 15.75 10.7933 15.794 10.9166 15.8765C11.0399 15.9589 11.1361 16.076 11.1928 16.2131ZM20.0306 6.96935L17.0306 3.96935C16.961 3.89962 16.8782 3.8443 16.7872 3.80656C16.6961 3.76882 16.5985 3.74939 16.5 3.74939C16.4014 3.74939 16.3038 3.76882 16.2128 3.80656C16.1217 3.8443 16.039 3.89962 15.9694 3.96935L12.9694 6.96935C12.8643 7.07425 12.7928 7.20794 12.7638 7.3535C12.7348 7.49906 12.7497 7.64996 12.8065 7.78707C12.8633 7.92419 12.9595 8.04137 13.083 8.12377C13.2064 8.20617 13.3516 8.2501 13.5 8.24998H15.75L15.75 19.5C15.75 19.6989 15.829 19.8897 15.9697 20.0303C16.1103 20.171 16.3011 20.25 16.5 20.25C16.6989 20.25 16.8897 20.171 17.0303 20.0303C17.171 19.8897 17.25 19.6989 17.25 19.5V8.24998L19.5 8.24998C19.6484 8.2501 19.7935 8.20617 19.917 8.12377C20.0404 8.04137 20.1366 7.92419 20.1934 7.78707C20.2503 7.64996 20.2651 7.49906 20.2361 7.3535C20.2071 7.20794 20.1356 7.07425 20.0306 6.96935Z" fill="#B3B3B3"/>
              </svg>`,
              ` <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M2.32032 10.8319C2.54179 8.97473 3.30139 7.22287 4.50563 5.79186C4.63888 5.63118 4.80419 5.50009 4.991 5.40695C5.17781 5.31382 5.382 5.2607 5.59051 5.251C5.79902 5.24129 6.00726 5.27521 6.20192 5.35058C6.39657 5.42596 6.57335 5.54113 6.72094 5.68874L9.31501 8.33811C9.56483 8.58736 9.71792 8.9173 9.74695 9.269C9.77597 9.62071 9.67903 9.97128 9.47344 10.2581C9.31772 10.479 9.20044 10.7247 9.12657 10.9847C9.1031 11.0614 9.05566 11.1286 8.9912 11.1763C8.92674 11.2241 8.84866 11.2499 8.76844 11.25L2.69344 11.25C2.64051 11.2501 2.58815 11.2389 2.53982 11.2174C2.49149 11.1958 2.44828 11.1642 2.41304 11.1247C2.37779 11.0852 2.35131 11.0387 2.33533 10.9882C2.31935 10.9377 2.31423 10.8844 2.32032 10.8319ZM12.8803 2.25561C12.6731 2.23754 12.4645 2.26276 12.2675 2.32965C12.0706 2.39654 11.8898 2.50365 11.7364 2.64418C11.5831 2.78471 11.4607 2.95558 11.377 3.14595C11.2932 3.33631 11.25 3.54201 11.25 3.74999V7.5628C11.2474 7.91659 11.3711 8.25971 11.5987 8.53053C11.8264 8.80134 12.1432 8.98208 12.4922 9.0403C13.1493 9.14871 13.7517 9.47271 14.2044 9.96123C14.6571 10.4498 14.9343 11.075 14.9924 11.7385C15.0505 12.402 14.8862 13.0659 14.5254 13.6257C14.1645 14.1855 13.6277 14.6093 12.9994 14.8303C12.9263 14.8572 12.8631 14.9058 12.8185 14.9697C12.7739 15.0336 12.75 15.1096 12.75 15.1875L12.75 21.3028C12.7497 21.3559 12.7606 21.4085 12.7821 21.457C12.8035 21.5056 12.8351 21.549 12.8746 21.5845C12.9141 21.6199 12.9608 21.6466 13.0113 21.6627C13.0619 21.6787 13.1154 21.6839 13.1681 21.6778C15.508 21.3889 17.6648 20.2647 19.2416 18.512C20.8185 16.7593 21.7092 14.496 21.75 12.1387C21.8203 7.04905 17.9241 2.70749 12.8803 2.25561ZM10.9922 14.8275C10.573 14.6779 10.1923 14.437 9.87769 14.1221C9.56311 13.8072 9.32255 13.4262 9.17344 13.0069C9.14788 12.9325 9.0999 12.8679 9.03611 12.8219C8.97231 12.7759 8.89584 12.7508 8.81719 12.75L2.69251 12.75C2.6395 12.7496 2.58703 12.7606 2.53854 12.782C2.49006 12.8034 2.44667 12.8349 2.41123 12.8743C2.3758 12.9137 2.34912 12.9602 2.33297 13.0107C2.31681 13.0612 2.31154 13.1145 2.31751 13.1672C2.58011 15.3341 3.5616 17.3505 5.10508 18.894C6.64856 20.4375 8.66492 21.4189 10.8319 21.6815C10.8846 21.6875 10.9379 21.6822 10.9884 21.6661C11.0389 21.6499 11.0853 21.6233 11.1248 21.5878C11.1642 21.5524 11.1956 21.509 11.2171 21.4605C11.2385 21.412 11.2494 21.3596 11.2491 21.3065L11.2491 15.1875C11.2492 15.1082 11.2245 15.0308 11.1785 14.9662C11.1324 14.9017 11.0672 14.8531 10.9922 14.8275Z" fill="#B3B3B3"/>
          </svg>`,
          ` <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M17.25 4.57594V3C17.25 2.60218 17.092 2.22064 16.8107 1.93934C16.5294 1.65804 16.1478 1.5 15.75 1.5L8.25 1.5C7.85218 1.5 7.47064 1.65804 7.18934 1.93934C6.90804 2.22064 6.75 2.60218 6.75 3V4.57594C5.90354 4.74962 5.14289 5.20995 4.59637 5.87926C4.04985 6.54857 3.75092 7.3859 3.75 8.25L3.75 18.75C3.75 19.7446 4.14509 20.6984 4.84835 21.4016C5.55161 22.1049 6.50544 22.5 7.5 22.5L16.5 22.5C17.4946 22.5 18.4484 22.1049 19.1517 21.4016C19.8549 20.6984 20.25 19.7446 20.25 18.75L20.25 8.25C20.2491 7.3859 19.9501 6.54857 19.4036 5.87926C18.8571 5.20995 18.0965 4.74962 17.25 4.57594ZM11.25 3L12.75 3V4.5H11.25V3ZM8.25 3H9.75V4.5H8.25V3ZM12.75 17.25V18C12.75 18.1989 12.671 18.3897 12.5303 18.5303C12.3897 18.671 12.1989 18.75 12 18.75C11.8011 18.75 11.6103 18.671 11.4697 18.5303C11.329 18.3897 11.25 18.1989 11.25 18V17.25H10.5C10.3011 17.25 10.1103 17.171 9.96967 17.0303C9.82902 16.8897 9.75 16.6989 9.75 16.5C9.75 16.3011 9.82902 16.1103 9.96967 15.9697C10.1103 15.829 10.3011 15.75 10.5 15.75H12.75C12.9489 15.75 13.1397 15.671 13.2803 15.5303C13.421 15.3897 13.5 15.1989 13.5 15C13.5 14.8011 13.421 14.6103 13.2803 14.4697C13.1397 14.329 12.9489 14.25 12.75 14.25H11.25C10.6533 14.25 10.081 14.0129 9.65901 13.591C9.23705 13.169 9 12.5967 9 12C9 11.4033 9.23705 10.831 9.65901 10.409C10.081 9.98705 10.6533 9.75 11.25 9.75V9C11.25 8.80109 11.329 8.61032 11.4697 8.46967C11.6103 8.32902 11.8011 8.25 12 8.25C12.1989 8.25 12.3897 8.32902 12.5303 8.46967C12.671 8.61032 12.75 8.80109 12.75 9V9.75H13.5C13.6989 9.75 13.8897 9.82902 14.0303 9.96967C14.171 10.1103 14.25 10.3011 14.25 10.5C14.25 10.6989 14.171 10.8897 14.0303 11.0303C13.8897 11.171 13.6989 11.25 13.5 11.25H11.25C11.0511 11.25 10.8603 11.329 10.7197 11.4697C10.579 11.6103 10.5 11.8011 10.5 12C10.5 12.1989 10.579 12.3897 10.7197 12.5303C10.8603 12.671 11.0511 12.75 11.25 12.75H12.75C13.3467 12.75 13.919 12.9871 14.341 13.409C14.7629 13.831 15 14.4033 15 15C15 15.5967 14.7629 16.169 14.341 16.591C13.919 17.0129 13.3467 17.25 12.75 17.25ZM15.75 4.5H14.25V3H15.75V4.5Z" fill="#B3B3B3"/>
          </svg>`,
          ` <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M20.25 3.75L3.75 3.75C3.35218 3.75 2.97064 3.90804 2.68934 4.18934C2.40804 4.47064 2.25 4.85218 2.25 5.25L2.25 19.5C2.25007 19.6278 2.28281 19.7535 2.34511 19.8651C2.40741 19.9768 2.49721 20.0706 2.60597 20.1378C2.71474 20.2049 2.83887 20.2432 2.96657 20.2489C3.09427 20.2546 3.22131 20.2275 3.33563 20.1703L6 18.8381L8.66437 20.1703C8.76857 20.2225 8.88348 20.2496 9 20.2496C9.11652 20.2496 9.23143 20.2225 9.33563 20.1703L12 18.8381L14.6644 20.1703C14.7686 20.2225 14.8835 20.2496 15 20.2496C15.1165 20.2496 15.2314 20.2225 15.3356 20.1703L18 18.8381L20.6644 20.1703C20.7787 20.2275 20.9057 20.2546 21.0334 20.2489C21.1611 20.2432 21.2853 20.2049 21.394 20.1378C21.5028 20.0706 21.5926 19.9768 21.6549 19.8651C21.7172 19.7535 21.7499 19.6278 21.75 19.5L21.75 5.25C21.75 4.85218 21.592 4.47064 21.3107 4.18934C21.0294 3.90804 20.6478 3.75 20.25 3.75ZM16.5 13.5L7.5 13.5C7.30109 13.5 7.11032 13.421 6.96967 13.2803C6.82902 13.1397 6.75 12.9489 6.75 12.75C6.75 12.5511 6.82902 12.3603 6.96967 12.2197C7.11032 12.079 7.30109 12 7.5 12L16.5 12C16.6989 12 16.8897 12.079 17.0303 12.2197C17.171 12.3603 17.25 12.5511 17.25 12.75C17.25 12.9489 17.171 13.1397 17.0303 13.2803C16.8897 13.421 16.6989 13.5 16.5 13.5ZM16.5 10.5L7.5 10.5C7.30109 10.5 7.11032 10.421 6.96967 10.2803C6.82902 10.1397 6.75 9.94891 6.75 9.75C6.75 9.55109 6.82902 9.36032 6.96967 9.21967C7.11032 9.07902 7.30109 9 7.5 9L16.5 9C16.6989 9 16.8897 9.07902 17.0303 9.21967C17.171 9.36032 17.25 9.55109 17.25 9.75C17.25 9.94891 17.171 10.1397 17.0303 10.2803C16.8897 10.421 16.6989 10.5 16.5 10.5Z" fill="#B3B3B3"/>
      </svg>`
            ]
          minimizationIcons: string[] = [
            `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25" fill="none">
      <path d="M15.0001 8.26002L15.0001 17.26C15.0001 17.4589 14.9211 17.6497 14.7804 17.7904C14.6398 17.931 14.449 18.01 14.2501 18.01H12.0001L12.0001 21.76C12.0002 21.9084 11.9563 22.0536 11.8739 22.177C11.7915 22.3005 11.6743 22.3967 11.5372 22.4535C11.4001 22.5103 11.2492 22.5252 11.1036 22.4962C10.9581 22.4672 10.8244 22.3957 10.7195 22.2906L1.71948 13.2906C1.64974 13.221 1.59443 13.1383 1.55668 13.0472C1.51894 12.9562 1.49951 12.8586 1.49951 12.76C1.49951 12.6615 1.51894 12.5639 1.55668 12.4728C1.59443 12.3818 1.64974 12.2991 1.71948 12.2294L10.7195 3.2294C10.8244 3.12439 10.9581 3.05286 11.1036 3.02387C11.2492 2.99489 11.4001 3.00974 11.5372 3.06655C11.6743 3.12337 11.7915 3.21959 11.8739 3.34303C11.9563 3.46648 12.0002 3.6116 12.0001 3.76002V7.51002H14.2501C14.449 7.51002 14.6398 7.58904 14.7804 7.72969C14.9211 7.87034 15.0001 8.06111 15.0001 8.26002ZM17.2501 7.51002C17.0512 7.51002 16.8604 7.58904 16.7198 7.72969C16.5791 7.87034 16.5001 8.06111 16.5001 8.26002V17.26C16.5001 17.4589 16.5791 17.6497 16.7198 17.7904C16.8604 17.931 17.0512 18.01 17.2501 18.01C17.449 18.01 17.6398 17.931 17.7804 17.7904C17.9211 17.6497 18.0001 17.4589 18.0001 17.26L18.0001 8.26002C18.0001 8.06111 17.9211 7.87034 17.7804 7.72969C17.6398 7.58904 17.449 7.51002 17.2501 7.51002ZM20.2501 7.51002C20.0512 7.51002 19.8604 7.58904 19.7198 7.72969C19.5791 7.87034 19.5001 8.06111 19.5001 8.26002L19.5001 17.26C19.5001 17.4589 19.5791 17.6497 19.7198 17.7904C19.8604 17.931 20.0512 18.01 20.2501 18.01C20.449 18.01 20.6398 17.931 20.7804 17.7904C20.9211 17.6497 21.0001 17.4589 21.0001 17.26L21.0001 8.26002C21.0001 8.06111 20.9211 7.87034 20.7804 7.72969C20.6398 7.58904 20.449 7.51002 20.2501 7.51002Z" fill="#B3B3B3"/>
    </svg>`
          ]
        navigateTo(path: string) {
   
           this.navigationBtns.update(arr => {
            return arr.map((el) => {
              if (el.path == path) {
                el.isActive = true;
                return el;
              }
              if (el.isActive == true) {
                el.isActive = false;
              }
              return el;
            })
          })
          console.log("navigation btns are: ")
          console.log(this.navigationBtns())
          this.router.navigate(['/' + path]);
         
        }

        toggleMinimization() {
          this.isShown.update((bool: boolean) => !bool)
        }
}
